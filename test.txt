test_df["quarter"] = test_df["time"].dt.quarter
test_df["quarter_sin"] = np.sin(2 * np.pi * test_df["quarter"] / 4)
test_df["quarter_cos"] = np.cos(2 * np.pi * test_df["quarter"] / 4)

test_df["hour"] = test_df["time"].dt.hour
test_df["hour_sin"] = np.sin(2 * np.pi * test_df["hour"] / 24)
test_df["hour_cos"] = np.cos(2 * np.pi * test_df["hour"] / 24)

test_df["minute"] = test_df["time"].dt.minute
test_df["minute_sin"] = np.sin(2 * np.pi * test_df["minute"] / 60)
test_df["minute_cos"] = np.cos(2 * np.pi * test_df["minute"] / 60)

test_df["day_of_year"] = test_df["time"].dt.dayofyear
test_df["dayofyear_sin"] = np.sin(2 * np.pi * test_df["day_of_year"] / 366)
test_df["dayofyear_cos"] = np.cos(2 * np.pi * test_df["day_of_year"] / 366)

test_df["week_of_year"] = test_df["time"].dt.isocalendar().week
test_df["week_sin"] = np.sin(2 * np.pi * test_df["week_of_year"] / 52)
test_df["week_cos"] = np.cos(2 * np.pi * test_df["week_of_year"] / 52)

# Day of month (1â€“31)
test_df["day_of_month"] = test_df["time"].dt.day
test_df["dayofmonth_sin"] = np.sin(2 * np.pi * test_df["day_of_month"] / 31)
test_df["dayofmonth_cos"] = np.cos(2 * np.pi * test_df["day_of_month"] / 31)

test_df["month_of_year"] = test_df["time"].dt.month
test_df["monthofyear_sin"] = np.sin(2 * np.pi * test_df["month_of_year"] / 12)
test_df["monthofyear_cos"] = np.cos(2 * np.pi * test_df["month_of_year"] / 12)

# Weekday (0=Mon, 6=Sun) and is_weekend
test_df["weekday"] = test_df["time"].dt.weekday
test_df["weekday_sin"] = np.sin(2 * np.pi * test_df["weekday"] / 6)
test_df["weekday_cos"] = np.cos(2 * np.pi * test_df["weekday"] / 6)
test_df["is_weekend"] = test_df["weekday"].isin([5, 6]).astype(np.uint8)
test_df